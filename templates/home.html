<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PuzzNews</title>
    <link rel="stylesheet" href="static/css/style.css">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f4f8;
            font-family: 'Inter', sans-serif;
            margin: 0;
        }

        .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .logo-text {
            font-size: 4rem;
            font-weight: 800;
            color: #333;
            letter-spacing: -2px;
            margin: 0;
            user-select: none;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .logo-tagline {
            font-size: 1.2rem;
            color: #555;
            font-weight: 400;
            margin: 0;
        }

        .puzzle-svg {
            width: 150px;
            height: 150px;
            fill: none;
            stroke: #4a90e2;
            stroke-width: 5px;
            stroke-linecap: round;
            stroke-linejoin: round;
            filter: drop-shadow(4px 4px 8px rgba(0, 0, 0, 0.2));
            transition: transform 0.5s ease-in-out;
        }

        .logo-container:hover .puzzle-svg {
            transform: rotate(15deg) scale(1.1);
        }

        @keyframes rotate {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .animated-puzzle-svg {
            animation: rotate 10s linear infinite;
        }
    </style>
</head>

<body>
    <div class="logo-container">
        <svg class="puzzle-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M 50 50 L 150 50 L 150 100 L 100 100 A 25 25 0 0 1 100 150 L 50 150 A 25 25 0 0 1 50 100 L 50 50 Z" />
            <path d="M 150 50 L 150 150 L 100 150 A 25 25 0 0 1 100 100 L 150 100 Z" stroke="#e27c4a"
                stroke-width="5" />
        </svg>
        <div class="logo-text">PuzzNews</div>
        <div class="logo-tagline">ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®æ–­ç‰‡ã‚’ã€ã¤ãªãåˆã‚ã›ã‚‹ã€‚</div>
    </div>

    <div class="background-container">
        <!-- èƒŒæ™¯ç”»åƒã¯CSSã§è¨­å®šã•ã‚Œã¾ã™ -->
        <div class="overlay-content">
            <div class="search-form-container">
                <!-- <h1 class="main-title">ãƒ‹ãƒ¥ãƒ¼ã‚¹æ¤œç´¢</h1> -->
                <form action="/" method="post" class="search-form">
                    <input type="text" name="keyword" placeholder="ğŸ”æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›" required>
                    <button type="submit">æ¤œç´¢</button>
                </form>
            </div>

            <!-- ãŠã™ã™ã‚ãƒ¯ãƒ¼ãƒ‰ã‚«ãƒƒãƒˆ -->
            <div class="puzzle-pieces">
                <a href="{{ url_for('select', keyword='AI') }}" class="piece piece1">
                    <img src="{{ url_for('static', filename='images/piece_brown.png') }}">
                    <p class="label1">AI</p>
                </a>
                <a href="{{ url_for('select', keyword='æ”¿æ²»') }}" class="piece piece2">
                    <img src="{{ url_for('static', filename='images/piece_green.png') }}">
                    <p class="label2">æ”¿æ²»</p>
                </a>
                <a href="{{ url_for('select', keyword='æ°—å€™å¤‰å‹•') }}" class="piece piece3">
                    <img src="{{ url_for('static', filename='images/piece_pink.png') }}">
                    <p class="label3">æ°—å€™å¤‰å‹•</p>
                </a>
            </div>


            <!-- ã‚¬ãƒãƒ£ã‚¬ãƒãƒ£ã®ç”»åƒã‚’é…ç½® -->
            <!-- cssã«åˆã‚ã›ã¦machineã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ  -->
            <img src="{{ url_for('static', filename='images/gachapon.png') }}" alt="ã‚¬ãƒãƒ£ã‚¬ãƒãƒ£" id="gacha"
                style="cursor:pointer;">
        </div>
    </div>

    <script>
        document.getElementById("gacha").addEventListener("click", function () {
            // ã‚¬ãƒãƒ£ã‚¬ãƒãƒ£ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰ã€/gacha ãƒ«ãƒ¼ãƒˆã«é·ç§»
            window.location.href = "{{ url_for('gacha') }}";
        });

        // ãƒ”ãƒ¼ã‚¹ã®å‹•çš„ãªé…ç½®ãƒ­ã‚¸ãƒƒã‚¯
        function placePieces() {
            const pieces = document.querySelectorAll('.piece');
            const searchForm = document.querySelector('.search-form-container');
            const gacha = document.getElementById('gacha');
            const container = document.querySelector('.overlay-content');

            const containerRect = container.getBoundingClientRect();
            const searchRect = searchForm.getBoundingClientRect();
            const gachaRect = gacha.getBoundingClientRect();

            const placedRects = [
                // æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ ã¨ã‚¬ãƒãƒ£ã‚¬ãƒãƒ£ã®é ˜åŸŸã‚’åˆæœŸé…ç½®ã¨ã—ã¦è¨­å®š
                { left: searchRect.left, top: searchRect.top, right: searchRect.right, bottom: searchRect.bottom, width: searchRect.width, height: searchRect.height },
                { left: gachaRect.left, top: gachaRect.top, right: gachaRect.right, bottom: gachaRect.bottom, width: gachaRect.width, height: gachaRect.height }
            ];

            pieces.forEach(piece => {
                const pieceRect = piece.getBoundingClientRect();
                let isOverlapping = true;
                let attempts = 0;
                const maxAttempts = 100;

                while (isOverlapping && attempts < maxAttempts) {
                    attempts++;

                    // æ–°ã—ã„ãƒ©ãƒ³ãƒ€ãƒ ãªä½ç½®ã‚’è¨ˆç®—
                    const minY = searchRect.bottom;
                    const maxY = gachaRect.top - pieceRect.height;
                    const newY = Math.random() * (maxY - minY) + minY;

                    // å·¦å³ã«10%ãšã¤ã®ä½™ç™½ã‚’è¨­ã‘ã‚‹
                    const margin = containerRect.width * 0.3;
                    const minX = margin;
                    const maxX = containerRect.width - pieceRect.width - margin;
                    const newX = Math.random() * (maxX - minX) + minX;

                    // é‡ãªã‚Šåˆ¤å®šç”¨ã®ä»®ã®çŸ©å½¢ã‚’ä½œæˆ
                    const tempRect = {
                        left: newX,
                        top: newY,
                        right: newX + pieceRect.width,
                        bottom: newY + pieceRect.height
                    };

                    isOverlapping = false;

                    // ã™ã§ã«é…ç½®ã•ã‚ŒãŸã™ã¹ã¦ã®è¦ç´ ã¨é‡ãªã£ã¦ã„ãªã„ã‹ãƒã‚§ãƒƒã‚¯
                    for (const rect of placedRects) {
                        if (
                            tempRect.left < rect.right &&
                            tempRect.right > rect.left &&
                            tempRect.top < rect.bottom &&
                            tempRect.bottom > rect.top
                        ) {
                            isOverlapping = true;
                            break;
                        }
                    }

                    // é‡ãªã‚ŠãŒãªã‘ã‚Œã°ã€ã“ã®ä½ç½®ã‚’ç¢ºå®šã—ã€placedRectsã«è¿½åŠ 
                    if (!isOverlapping) {
                        piece.style.left = `${newX}px`;
                        piece.style.top = `${newY}px`;
                        piece.style.position = 'absolute';
                        placedRects.push(tempRect); // æ–°ã—ã„ä½ç½®æƒ…å ±ã‚’è¨˜éŒ²
                        break;
                    }
                }

                if (attempts === maxAttempts) {
                    console.warn("ãƒ”ãƒ¼ã‚¹ã®é…ç½®ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
                }
            });
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã¨ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚ºæ™‚ã«å®Ÿè¡Œ
        window.addEventListener('load', placePieces);
        window.addEventListener('resize', placePieces);
    </script>
</body>


</html>